# FUNCTION DESCRIPTIONS

### ./Lamda/dbtils/DynamoDbFunction.js

| **Function Name**               | **Function Description**                                         | **Arguments**                                                                                                                                                                                   | **Return**                        | **Usage**                                                              |
| ------------------------------- | ---------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------- | ---------------------------------------------------------------------- |
| `establishConnection`           | Establishes a DynamoDB document client connection.               | `logLevel` – Log verbosity                                                                                                                                                                      | `AWS.DynamoDB.DocumentClient`     | Used internally to create a DynamoDB client instance.                  |
| `closeConnection`               | Closes the HTTPS agent used for the DynamoDB client.             | `logLevel` – Log verbosity                                                                                                                                                                      | `void`                            | Call after DynamoDB operations if manual connection cleanup is needed. |
| `putFunction`                   | Inserts a new item into a DynamoDB table.                        | `tableName`, `item`, `documentClient` (optional), `logLevel`                                                                                                                                    | `Promise` (DynamoDB response)     | Add or replace an item in the specified table.                         |
| `updateFunction`                | Updates a specific item in DynamoDB with expressions.            | `tableName`, `key`, `updateExpression`, `expressionAttributeValues`, `expressionAttributeNames`, `documentClient` (optional), `logLevel`                                                        | `Promise` (updated item response) | Modify fields of a specific item using update expressions.             |
| `updateFunctionMultiple`        | Updates multiple fields of an item in DynamoDB.                  | `tableName`, `key`, `updates` (object of fields and values), `documentClient` (optional), `logLevel`                                                                                            | `Promise`                         | Simplified bulk update using attribute mapping.                        |
| `ScanDynamodbBYItems`           | Scans table with filters, paginates internally.                  | `tableName`, `filterExpressions`, `expressionAttributeValues`, `documentClient` (optional), `logLevel`                                                                                          | `Array` of matched items          | Fetch items based on filter expressions.                               |
| `ScanDynamodbFullTable`         | Scans full table with optional pagination and limit.             | `tableName`, `lastEvaluatedKey` (optional), `count` (optional), `documentClient` (optional), `logLevel`                                                                                         | `Array` of all items              | Retrieve all items from the table or paginated set.                    |
| `deleteItemByKey`               | Deletes a specific item by key from the table.                   | `tableName`, `key`, `documentClient` (optional)                                                                                                                                                 | `Promise`                         | Deletes a record using its primary key.                                |
| `getItemByKey`                  | Gets a specific item by key from the table.                      | `tableName`, `key`, `documentClient` (optional), `logLevel`                                                                                                                                     | `Object` (single item)            | Fetch a record by its primary key.                                     |
| `ScanDynamodbWithProjection`    | Scans table and returns only specific fields using projections.  | `tableName`, `projectionExpression`, `filterExpression`, `expressionAttributeValues`, `documentClient` (optional)                                                                               | `Array` of projected items        | Optimized scan to reduce data load by selecting specific fields.       |
| `queryDynamoDBWithGSI`          | Queries a GSI with key conditions and optional projection.       | `tableName`, `indexNames` (array), `keyConditionExpression`, `expressionAttributeValues`, `projectionExpression` (optional), `lastEvaluatedKey`, `documentClient`, `logLevel`                   | `Array` of items                  | Query using a Global Secondary Index (GSI), supports pagination.       |
| `queryDynamoDBWithGSIAndFilter` | Queries a GSI with key conditions and applies filter expression. | `tableName`, `indexNames`, `keyConditionExpression`, `filterExpression`, `expressionAttributeValues`, `projectionExpression`, `lastEvaluatedKey`, `documentClient`, `logLevel`                  | `Array` of filtered items         | Query and filter results based on non-key attributes.                  |
| `paginateQuery`                 | Performs a paginated query with count and optional filters.      | `tableName`, `indexNames`, `keyConditionExpression`, `expressionAttributeValues`, `lastKey`, `count`, `scanIndex`, `filterExpression`, `expressionAttributeNames`, `documentClient`, `logLevel` | `Promise` (query result page)     | Paginate through items with filters, projection, and count.            |

---

### ./Lamda/dbutils/calculatedComputedField_ValueBasedOnHeadIdApi.js

| **Function Name**                            | **Function Description**                                                         | **Arguments**                                                                                              | **Return**                                 | **Usage**                                                                                                   |
| -------------------------------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- | ------------------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| `Computed_Field_Value`                       | Computes a value based on a field and formula for a given object.                | `numberFieldId`, `formulaId`, `obj_id`                                                                     | `Number` (computed value)                  | Used to compute aggregate (sum or average) based on formula and field position.                             |
| `calculatedComputedField_ValueBasedOnHeadId` | Computes field value based on `heapId` and conditional formulas.                 | `fieldInformation` (object), `heapId`, `documentClient` (optional)                                         | `Number` (computed value)                  | Computes conditional values based on formula, supports `sum`, `avg`, `min`, `max`, and custom filter logic. |
| `customSort`                                 | Custom sort function that handles both numeric and string values in given order. | `data` (array of objects), `sortField` (string), `sortOrder` (1 for ASC, -1 for DESC)                      | `void` (modifies array in-place)           | Sorts array of objects by specified field in the desired order.                                             |
| `splitAndStore`                              | Uploads RTF content to S3 and maps the uploaded paths to field positions.        | `arr` (array of objects with `VALUE`, `FIELD_ID`, `FIELD_POSITION`), `heapid` (string), `PRODUCT` (string) | `Object` (map of FIELD\_POSITION: S3 path) | Uploads text content to S3 and returns mapping of uploaded object keys to field positions.                  |

---

### ./Lamda/dbutils/commonFunctionForAllTable.js

| **Function Name**                | **Description**                                                                   | **Arguments**                                     | **Returns**                             | **Usage**                                                             |
| -------------------------------- | --------------------------------------------------------------------------------- | ------------------------------------------------- | --------------------------------------- | --------------------------------------------------------------------- |
| `objectPermissionDetails`        | Fetches object permission details from `Object_Permission_Master` using `OBJ_ID`. | `documentClient`, `obj`, `logLevel`               | List of matching object permissions     | Used to check what object-level permissions exist for a given object. |
| `addDatainObjectPermissionTable` | Inserts data into `Object_Permission_Master`.                                     | `documentClient`, `obj`, `logLevel`               | `void`                                  | To store object permission entries.                                   |
| `fieldPermissionDetails`         | Fetches field permission data for an object from `Field_Permission_Master`.       | `documentClient`, `obj`, `logLevel`               | List of matching field permissions      | Retrieve field-level permissions for a specific object.               |
| `addDatainFieldPermissionTable`  | Inserts data into `Field_Permission_Master`.                                      | `documentClient`, `obj`, `logLevel`               | `void`                                  | To store field permission entries.                                    |
| `objectFieldDetails`             | Gets all field details associated with an object from `Field_Master`.             | `documentClient`, `obj`, `logLevel`               | List of object fields                   | Used to fetch metadata fields for a specific object.                  |
| `getFieldDetails`                | Fetches a specific field's details from `Field_Master` by `FIELD_ID`.             | `documentClient`, `obj`, `logLevel`               | Field object or `[]`                    | Used to get metadata or config about a specific field.                |
| `getRecordDetails`               | Fetches a record from `Data_Heap` by `ID`.                                        | `documentClient`, `obj`, `logLevel`               | Record object or `[]`                   | Used for reading saved data records.                                  |
| `getObjectDetails`               | Fetches object details from `Object_Master` using `OBJ_ID`.                       | `objId`, `documentClient`, `logLevel`             | Object metadata                         | Used to check object config, labels, layout, etc.                     |
| `getDashboardLayoutDetails`      | Gets layout details from `Dashboard_Layout_Master`.                               | `dashboardLayoutId`, `documentClient`, `logLevel` | Layout object                           | For rendering or configuring dashboards.                              |
| `getLayoutDetails`               | Gets layout info from `Page_Layout_Master`.                                       | `layoutId`, `documentClient`, `logLevel`          | Layout object                           | Used to structure how an object/page is presented.                    |
| `userTokenDetails`               | Fetches token info from `Token_Master` using `USER_TOKEN`.                        | `auth`, `logLevel`                                | List of token entries                   | Used to validate or read token session info.                          |
| `insertDataInTokenMaster`        | Inserts a token into `Token_Master`.                                              | `email`, `auth`, `timeStamp`, `logLevel`          | `void`                                  | Stores user token and timestamp during login.                         |
| `getLanguageListByCode`          | Fetches language data by `Language_Code`.                                         | `languageCode`, `logLevel`                        | List of language entries                | Used to load i18n/localization config.                                |
| `getWorkspace`                   | Fetches workspace data from `Workspace_Master` using `WORKSPACE_MASTER_ID`.       | `workspaceId`, `documentClient`, `logLevel`       | Workspace object                        | Used to get workspace config/details.                                 |
| `workspaceMetaData`              | Gets metadata for a workspace from `Workspace_Style_Master`.                      | `workspaceId`, `documentClient`, `logLevel`       | List of metadata entries                | Retrieves styling/config info for a workspace.                        |
| `userWorkspaceList`              | Fetches all workspaces where user is a member.                                    | `documentClient`, `email`, `logLevel`             | Sorted list of workspaces with metadata | To list available workspaces for the user.                            |
| `userMemberDetails`              | Returns membership info for a user in a workspace.                                | `workspaceId`, `userId`, `logLevel`               | List of membership records              | Used to check if a user is part of a workspace.                       |
| `getUseridByEmail`               | Gets user details from `User_Master` by email.                                    | `email`, `documentClient`, `logLevel`             | List of user records                    | To map email to `USER_ID`.                                            |
| `returnCurrentTimeStamp`         | Returns the current timestamp in milliseconds.                                    | `logLevel`                                        | Timestamp                               | Used for storing time-related fields.                                 |
| `objectSecurityDetails`          | Fetches security config for an object from `Object_Security_Master`.              | `obj`, `documentClient`                           | List of security records                | Determines what security is applied to an object.                     |
| `getQueryDetails`                | Gets a saved query from `Query_Master`.                                           | `documentClient`, `QUERY_MASTER_ID`               | Query config                            | To execute or edit saved user queries.                                |
| `getFormulaStructure`            | Fetches formula structure either by `FORMULA_ID` or `FORMULA_LIST_ID`.            | `obj`, `documentClient`                           | List of formulas                        | Used to compute or understand calculated fields.                      |
| `workspaceRoleList`              | Fetches roles available for a workspace.                                          | `obj`, `documentClient`                           | List of roles                           | For permission config and role management.                            |

---

### ./Lamda/dbutils/commonFunction.js

| **Function Name**                  | **Function Description**                                                                                                                | **Arguments**                                             | **Returns**                                         | **Usage**                                                                                      |                                                          |
| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------- | --------------------------------------------------- | ---------------------------------------------------------------------------------------------- | -------------------------------------------------------- |
| `getWorkspaceConfigDetails`        | Retrieves workspace configuration records based on `TYPE` filter (e.g., `null`, `"member"`, `"Object"`) from `Workspace_Config_Master`. | `documentClient`, `obj`, `logLevel`                       | List of workspace config entries                    | Used to fetch workspace configurations dynamically based on type.                              |                                                          |
| `lookupObjectFieldList`            | Given a record heap ID, retrieves its object ID and corresponding field metadata.                                                       | `documentClient`, `masterRecordHeapId`, `logLevel`        | `{ OBJ_ID, OBJ_FIELDS }`                            | Used for resolving fields of a lookup object in a record.                                      |                                                          |
| `checkIdandLookupObjId`            | Checks whether a lookup object ID exists for a given record ID to avoid redundant DB calls.                                             | `recordId`, `lookupObjects`, `documentClient`, `logLevel` | \`{ CALL\_DISABLE: boolean, OBJ\_ID: string         | undefined }\`                                                                                  | Optimizes whether a lookup API call is necessary or not. |
| `dataMakingForDynamicLookupApi`    | Enriches records with dynamic lookup data and field transformations like dates and references.                                          | `data`, `fieldData`, `documentClient`, `body`             | List of updated records with computed lookup values | Core logic for formatting records for UI/API with lookup and date conversions.                 |                                                          |
| `getAuthEnv`                       | Parses the domain string to return the environment identifier (e.g., `-dev`, `-test`).                                                  | `domain`                                                  | `"-dev"` or `"-test"` or `""`                       | Used to resolve environment suffix for multi-env support based on domain.                      |                                                          |
| `applyDecimalPrecision`            | Applies rounding or formatting logic to numbers based on `DECIMAL_PRECISION`.                                                           | `calculation`, `DECIMAL_PRECISION`                        | Formatted number                                    | Adjusts number precision for display or storage.                                               |                                                          |
| `updateValueForHigherFormulaLevel` | Updates values for higher-level formulas by resolving selected or computed fields from object fields and record.                        | `fieldDetails`, `record`, `dataArr`, `objFields`          | Updated `dataArr` with applied values               | Used in formula engine to resolve dependencies between fields and populate values accordingly. |                                                          |

---

### ./Lamda/dbutils/dateFunction.js

| **Function Name**             | **Function Description**                                                                          | **Arguments**             | **Return**                                             | **Usage**                                                                 |
| ----------------------------- | ------------------------------------------------------------------------------------------------- | ------------------------- | ------------------------------------------------------ | ------------------------------------------------------------------------- |
| `currentDate`                 | Returns the current date's timestamp with time set to 00:00:00.                                   | None                      | `timestamp` (number)                                   | Used when filtering or comparing with today's start of the day.           |
| `firstDateOfMonth`            | Returns the timestamp of the first day of the current month at 00:00:00.                          | None                      | `timestamp` (number)                                   | Useful for filtering from the beginning of the current month.             |
| `lastDateOfMonth`             | Returns the timestamp of the last day of the current month at 00:00:00.                           | None                      | `timestamp` (number)                                   | Useful for setting an upper bound for current month queries.              |
| `returnDataInTimestamp`       | Returns a timestamp object `{ ACTUAL_DATE, AFTER_DATE, BEFORE_DATE }` based on filter conditions. | `filterCriteria` (object) | Object with `ACTUAL_DATE`, `AFTER_DATE`, `BEFORE_DATE` | Central logic for interpreting "SR-002", "SR-003", "SR-004" date filters. |
| `getTimestampAccordingToDate` | Converts a `dateString` (e.g., `"2025-06-21"`) to a timestamp at 00:00:00.                        | `dateString` (string)     | `timestamp` (number)                                   | Converts readable date to comparable timestamp.                           |
| `getDateAccordingToTimestamp` | Converts a timestamp to date in `"YYYY-MM-DD"` format.                                            | `timestamp` (number)      | `dateString` (string)                                  | Used for displaying stored timestamps in a readable format.               |
| `getDateTimeByTimestamp`      | Converts a timestamp to full date-time string in `DD/MM/YYYY, HH:MM:SS AM/PM` format (IST).       | `timestamp` (number)      | `dateTimeString` (string)                              | For displaying timestamps with time in a human-readable format (IST).     |

---

### ./Lamda/dbutils/s3Function.js

| **Function Name**          | **Function Description**                                                                               | **Arguments**                                           | **Return**                               | **Usage**                                                                  |
| -------------------------- | ------------------------------------------------------------------------------------------------------ | ------------------------------------------------------- | ---------------------------------------- | -------------------------------------------------------------------------- |
| `provideFileListFromS3`    | Lists files (excluding empty directories) from a specific folder in an S3 bucket.                      | `bucketName` (string), `folderPath` (string)            | Array of `{ fileName, Key }`             | Used to fetch a flat list of files under a specific S3 folder.             |
| `listFilesFromDirectories` | Lists all files (excluding subfolders) from multiple S3 directories (prefixes), handling pagination.   | `bucketName` (string), `directories` (array of strings) | Array of `{ fileName, Key }`             | Collects files from multiple folder paths in S3 bucket.                    |
| `filterAndPushAttachments` | Filters an array of file objects to include only those whose S3 key matches the specified base folder. | `array` (array of file objects), `field` (string)       | Filtered array of matching file objects  | Filters file objects by directory path.                                    |
| `processArrays`            | Maps and joins objects from two arrays based on `OBJ_ID` and `DATA_TYPE_ID`, returning combined IDs.   | `dataArr` (array), `fieldArr` (array)                   | Array of strings in format `ID/FIELD_ID` | Used to generate key strings for files based on relationships in metadata. |

---

### ./Lamda/dbutils/validationToken.js

| **Function Name**    | **Function Description**                                                                                                 | **Arguments**                                              | **Return**                                                      | **Usage**                                                                                      |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------- | --------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |
| `validateCredential` | Validates a user's token and email against a stored token in DynamoDB. Handles token expiration and log setting updates. | `event`, `documentClient` (optional)                       | Object with `success`, `message`, `LOG_SETTING` or throws error | Used to authenticate users accessing an API with token-based access.                           |
| `validateBodyInput`  | Validates the input request body against a provided Joi schema.                                                          | `jsonInput` (stringified JSON), `schema` (Joi schema)      | Parsed and validated object or throws validation error          | Ensures request body matches expected format and values before proceeding with business logic. |
| `getUserToekn`       | Queries the `Token_Master` table for an existing user token.                                                             | `auth` (token), `email`, `documentClient`                  | Array of token records (typically 0 or 1 item)                  | Used internally for token validation checks.                                                   |
| `validationCheck`    | Sends token to remote Auth service to validate login session.                                                            | `auth` (token)                                             | Object with `email`, `message`, and `success` status            | Verifies token's validity against external authentication service.                             |
| `getUser`            | Retrieves user details from `User_Master` table using email.                                                             | `email`, `documentClient`                                  | Array of user records                                           | Fetches the corresponding user record to associate a valid token.                              |
| `createUserAccess`   | Inserts a new access token into `Token_Master` with log setting and timestamp.                                           | `userid`, `email`, `token`, `logSetting`, `documentClient` | `undefined` (success on no error)                               | Used when new token is validated externally and needs to be registered in the system.          |
| `updateUserToken`    | Updates login timestamp for a given token in `Token_Master`.                                                             | `token_Id`, `loginTime`, `documentClient`                  | `undefined`                                                     | Resets login expiry timer if token is valid and reused.                                        |
| `deleteToken`        | Deletes a token record from `Token_Master` table.                                                                        | `token_Id`, `documentClient`                               | `undefined`                                                     | Used when token is invalid or expired and needs to be removed.                                 |
| `validateBatchToken` | Validates a special batch token from `Batch_Logs` table using a composite GSI.                                           | `event`, `documentClient`                                  | Object with `success` and message (optional)                    | Used for batch process validation, ensuring job and token are valid and not expired.           |

---

### ./Lamda/dbutils/PrintConsoleLog.js

| **Function / Constant Name** | **Function Description**                                                                                              | **Arguments**                                                                          | **Return**  | **Usage**                                                                                       |
| ---------------------------- | --------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | ----------- | ----------------------------------------------------------------------------------------------- |
| `LogType`                    | Enum-like constant object defining types of logs with corresponding name and level (position in string).              | *None*                                                                                 | Object      | Used to identify and categorize different log levels/types in the logging system.               |
| `printConsoleLog`            | Core function that conditionally logs messages based on `LOG_SETTING` and the level of the log type.                  | `logType` (string), `logSetting` (string), `...input` (any number of arguments to log) | `undefined` | Internal logger used to display messages only when enabled by `LOG_SETTING`.                    |
| `printLog`                   | Wrapper around `printConsoleLog`, retrieves `LOG_SETTING` and passes input accordingly.                               | `logType` (string), `logLevel` (unused), `...input`                                    | `undefined` | Used to log messages with dynamic log levels (though `logLevel` is currently unused).           |
| `ssuitesLog`                 | Specialized logging function for `info` logs. Retrieves session-based `LOG_SETTING` and logs using `printConsoleLog`. | `...args` (arguments to log)                                                           | `undefined` | Preferred helper to print `info` logs within application modules where session context is used. |

---
